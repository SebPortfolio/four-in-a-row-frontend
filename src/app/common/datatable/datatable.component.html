<ngx-datatable
  #table
  class="bootstrap"
  [rows]="rows"
  [columns]="columns"
  [headerHeight]="30"
  [footerHeight]="30"
  [columnMode]="config?.columnFlex ? 'flex' : 'force'"
  [limit]="config?.limit ?? 10"
  [scrollbarH]="config?.scrollbarH ?? false"
  (sort)="onSort($event)"
  [externalSorting]="true"
  [messages]="messages"
>
  @for (col of columns; track col.prop) {
    <ngx-datatable-column
      [name]="col.name"
      [prop]="col.prop"
      [flexGrow]="config?.columnFlex ? (col.flexGrow ?? 1) : 0"
      [width]="col.width ?? 150"
      [minWidth]="col.minWidth ?? 50"
      [maxWidth]="col.maxWidth ?? undefined!"
    >
      <ng-template ngx-datatable-header-template>
        <div (click)="onSort(col.prop)" class="header-content" style="cursor: pointer">
          <span class="header-name">{{ col.name | translate }}</span>
          <span class="sort-icon-container">
            @if (getSortDir(col.prop) === 'asc') {
              <fa-icon [icon]="faCaretUp"></fa-icon>
            } @else if (getSortDir(col.prop) === 'desc') {
              <fa-icon [icon]="faCaretDown"></fa-icon>
            }
          </span>
        </div>
      </ng-template>

      <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
        @if (value !== undefined && value !== null && value !== '') {
          @if (col.transform) {
            <span>{{ col.transform(value) | translate }}</span>
          } @else if (col.href) {
            <a [routerLink]="col.href(row)">{{ value }}</a>
          } @else {
            {{ value }}
          }
        } @else {
          <span class="no-data-placeholder">
            {{ col.noDataStr }}
          </span>
        }
      </ng-template>
    </ngx-datatable-column>
  }

  <ngx-datatable-footer>
    @if (rows.length > 0) {
      <ng-template ngx-datatable-footer-template let-rowCount="rowCount" let-pageSize="pageSize" let-curPage="curPage">
        <div class="custom-footer-info">
          <span>
            {{ (curPage - 1) * pageSize + 1 }} bis
            {{ math.min(curPage * pageSize, rowCount) }}
            von {{ rowCount }}
          </span>
          <div class="footer-pagination">
            <button type="button" class="pager-btn" [disabled]="curPage === 1" (click)="changePage(1)">
              <fa-icon [icon]="faAnglesLeft"></fa-icon>
            </button>

            <button type="button" class="pager-btn" [disabled]="curPage === 1" (click)="changePage(curPage - 1)">
              <fa-icon [icon]="faAngleLeft"></fa-icon>
            </button>

            <span class="page-indicator">Seite {{ curPage }} / {{ math.ceil(rowCount / pageSize) }}</span>

            <button
              type="button"
              class="pager-btn"
              [disabled]="curPage === math.ceil(rowCount / pageSize)"
              (click)="changePage(curPage + 1)"
            >
              <fa-icon [icon]="faAngleRight"></fa-icon>
            </button>

            <button
              type="button"
              class="pager-btn"
              [disabled]="curPage === math.ceil(rowCount / pageSize)"
              (click)="changePage(math.ceil(rowCount / pageSize))"
            >
              <fa-icon [icon]="faAnglesRight"></fa-icon>
            </button>
          </div>
        </div>
      </ng-template>
    }
  </ngx-datatable-footer>
</ngx-datatable>
